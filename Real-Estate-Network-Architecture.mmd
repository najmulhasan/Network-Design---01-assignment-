flowchart TB
  classDef public fill:#a0d8ff,stroke:#1f4acb,color:#0a2b63,stroke-width:1px;
  classDef app fill:#fcd77f,stroke:#e18a00,color:#4c2b00,stroke-width:1px;
  classDef data fill:#ffb3b3,stroke:#cc4e4e,color:#5b0a0a,stroke-width:1px;
  classDef dev fill:#d6c6ff,stroke:#6a45c2,color:#1f0e56,stroke-width:1px;
  classDef external fill:#c9dcff,stroke:#3662ff,stroke-width:1px;
  classDef gateway fill:#b3f2ff,stroke:#1f7f99,stroke-width:1px;
  classDef aws fill:#e2d0ff,stroke:#7034c4,stroke-width:1px;
  classDef legend fill:#f2f2f2,stroke:#999;

  subgraph External[External & Control Plane]
    ExternalSvcs[External Services<br/>Payment APIs<br/>Listing Feeds<br/>KYC/ID]:::external
    DevAccess[Developer Access<br/>VPN · Bastion · IAM]:::external
    Internet[Internet / Users<br/>Route 53 DNS<br/>CloudFront CDN<br/>AWS WAF & Shield]:::gateway
  end

  Internet --> ALB_R1
  Internet --> ALB_R2
  DevAccess --> Region1
  DevAccess --> Region2
  ExternalSvcs --> INT1
  ExternalSvcs --> INT2

  subgraph Region1[Region 1 Primary · US East · VPC 10.0.0.0/16]
    subgraph AZ1a[AZ 1a]
      PB1a[Public Subnet<br/>ALB · NAT · IGW]:::public
      APP1a[Private App Subnet<br/>ECS/EC2 · API Pods · Chat]:::app
      DATA1a[Private DB Subnet<br/>RDS Multi-AZ Primary<br/>Redis · OpenSearch]:::data
    end
    subgraph AZ1b[AZ 1b]
      PB1b[Public Subnet<br/>ALB · NAT]:::public
      APP1b[Private App Subnet<br/>Auto Scaling Group]:::app
      DATA1b[Private DB Subnet<br/>Read Replica · Backups]:::data
    end
    INT1[Integration Subnet<br/>API GW · Lambda · EventBridge · SQS]:::app
    DEV1[Developer Subnet<br/>CI/CD · Test Beds · Code Repos]:::dev
  end

  subgraph Region2[Region 2 Secondary · EU West · VPC 10.1.0.0/16]
    subgraph AZ2a[AZ 2a]
      PB2a[Public Subnet<br/>ALB · NAT]:::public
      APP2a[Private App Subnet<br/>Microservices · Chat Edge]:::app
      DATA2a[Private DB Subnet<br/>RDS Replica · Redis]:::data
    end
    subgraph AZ2b[AZ 2b]
      PB2b[Public Subnet<br/>ALB · NAT]:::public
      APP2b[Private App Subnet<br/>Auto Scaling Group]:::app
      DATA2b[Private DB Subnet<br/>Analytics · DR]:::data
    end
    INT2[Integration Subnet<br/>Lambda · API GW · EventBridge]:::app
    DEV2[Developer Subnet<br/>EU Dev/Test Enclave]:::dev
  end

  subgraph AWSShared[AWS Shared Services]
    S3[S3 + Cross-Region Replication<br/>Property Images & Docs]:::aws
    CloudOps[CloudWatch · GuardDuty · X-Ray · Grafana]:::aws
    Messaging[SNS · EventBridge Global Bus]:::aws
  end

  ALB_R1 -.-> PB1a
  ALB_R2 -.-> PB2a
  APP1a --> DATA1a
  APP1b --> DATA1b
  APP2a --> DATA2a
  APP2b --> DATA2b
  INT1 --> ExternalSvcs
  INT2 --> ExternalSvcs
  DEV1 --> APP1a
  DEV2 --> APP2a
  DATA1a ==Replication==> DATA2a
  S3 ==CRR==> S3
  CloudOps --> Region1
  CloudOps --> Region2

  subgraph Legend[Legend]
    L1[Public Subnet]:::public
    L2[Private App Subnet]:::app
    L3[Private DB Subnet]:::data
    L4[Developer Subnet]:::dev
  end

